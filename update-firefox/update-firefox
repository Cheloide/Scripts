#!/bin/bash

is_user_root() {
    ! (( ${EUID:-0} || $(id -u) ))
}

if is_user_root; then

    TEMP_PATH=$(mktemp -d)
    rm -rf /opt/firefox

    wget -O $TEMP_PATH/firefox-latest.tar.bz2 'https://download.mozilla.org/?product=firefox-latest-ssl&os=linux64&lang=en-US'
    tar -C /opt -xf $TEMP_PATH/firefox-latest.tar.bz2

    sudo update-alternatives --install /usr/bin/firefox firefox /opt/firefox/firefox 1000
    sudo update-alternatives --install /usr/bin/x-www-browser x-www-browser /opt/firefox/firefox 1000
    sudo update-alternatives --install /usr/bin/gnome-www-browser gnome-www-browser /opt/firefox/firefox 1000
    sudo update-alternatives  --set firefox /opt/firefox/firefox
    sudo update-alternatives  --set x-www-browser /opt/firefox/firefox
    sudo update-alternatives  --set gnome-www-browser /opt/firefox/firefox
    
    printf "\n[Desktop Entry]\nName=Firefox\nName[bg]=Firefox\nName[ca]=Firefox\nName[cs]=Firefox\nName[el]=Firefox\nName[es]=Firefox\nName[fa]=Firefox\nName[fi]=Firefox\nName[fr]=Firefox\nName[hu]=Firefox\nName[it]=Firefox\nName[ja]=Firefox\nName[ko]=Firefox\nName[nb]=Firefox\nName[nl]=Firefox\nName[nn]=Firefox\nName[no]=Firefox\nName[pl]=Firefox\nName[pt]=Firefox\nName[pt_BR]=Firefox\nName[ru]=Firefox\nName[sk]=Firefox\nName[sv]=Firefox\nComment=Browse the World Wide Web\nComment[bg]=Сърфиране в Мрежата\nComment[ca]=Navegueu per el web\nComment[cs]=Prohlížení stránek World Wide Webu\nComment[de]=Im Internet surfen\nComment[el]=Περιηγηθείτε στον παγκόσμιο ιστό\nComment[es]=Navegue por la web\nComment[fa]=صفحات شبکه جهانی اینترنت را مرور نمایید\nComment[fi]=Selaa Internetin WWW-sivuja\nComment[fr]=Navigue sur Internet\nComment[hu]=A világháló böngészése\nComment[it]=Esplora il web\nComment[ja]=ウェブを閲覧します\nComment[ko]=웹을 돌아 다닙니다\nComment[nb]=Surf på nettet\nComment[nl]=Verken het internet\nComment[nn]=Surf på nettet\nComment[no]=Surf på nettet\nComment[pl]=Przeglądanie stron WWW \nComment[pt]=Navegue na Internet\nComment[pt_BR]=Navegue na Internet\nComment[ru]=Обозреватель Всемирной Паутины\nComment[sk]=Prehliadanie internetu\nComment[sv]=Surfa på webben\nGenericName=Web Browser\nGenericName[bg]=Интернет браузър\nGenericName[ca]=Navegador web\nGenericName[cs]=Webový prohlížeč\nGenericName[de]=Webbrowser\nGenericName[el]=Περιηγητής ιστού\nGenericName[es]=Navegador web\nGenericName[fa]=مرورگر اینترنتی\nGenericName[fi]=WWW-selain\nGenericName[fr]=Navigateur Web\nGenericName[hu]=Webböngésző\nGenericName[it]=Browser Web\nGenericName[ja]=ウェブ・ブラウザ\nGenericName[ko]=웹 브라우저\nGenericName[nb]=Nettleser\nGenericName[nl]=Webbrowser\nGenericName[nn]=Nettlesar\nGenericName[no]=Nettleser\nGenericName[pl]=Przeglądarka WWWNetwork;WebBrowser;\nGenericName[pt]=Navegador Web\nGenericName[pt_BR]=Navegador WebNetwork;WebBrowser;\nGenericName[ru]=Интернет-браузер\nGenericName[sk]=Internetový prehliadač\nGenericName[sv]=Webbläsare\nX-GNOME-FullName=Firefox Web Browser\nX-GNOME-FullName[bg]=Интернет браузър (Firefox)\nX-GNOME-FullName[ca]=Navegador web Firefox\nX-GNOME-FullName[cs]=Firefox Webový prohlížeč\nX-GNOME-FullName[el]=Περιηγήτης Ιστού Firefox\nX-GNOME-FullName[es]=Navegador web Firefox\nX-GNOME-FullName[fa]=مرورگر اینترنتی Firefox\nX-GNOME-FullName[fi]=Firefox-selain\nX-GNOME-FullName[fr]=Navigateur Web Firefox\nX-GNOME-FullName[hu]=Firefox webböngésző\nX-GNOME-FullName[it]=Firefox Browser Web\nX-GNOME-FullName[ja]=Firefox ウェブ・ブラウザ\nX-GNOME-FullName[ko]=Firefox 웹 브라우저\nX-GNOME-FullName[nb]=Firefox Nettleser\nX-GNOME-FullName[nl]=Firefox webbrowser\nX-GNOME-FullName[nn]=Firefox Nettlesar\nX-GNOME-FullName[no]=Firefox Nettleser\nX-GNOME-FullName[pl]=Przeglądarka WWW Firefox\nX-GNOME-FullName[pt]=Firefox Navegador Web\nX-GNOME-FullName[pt_BR]=Navegador Web Firefox\nX-GNOME-FullName[ru]=Интернет-браузер Firefox\nX-GNOME-FullName[sk]=Internetový prehliadač Firefox\nX-GNOME-FullName[sv]=Webbläsaren Firefox\nExec=/usr/bin/firefox \nTerminal=false\nX-MultipleArgs=false\nType=Application\nIcon=/opt/firefox/browser/chrome/icons/default/default128.png\nCategories=Network;WebBrowser;\nMimeType=text/html;text/xml;application/xhtml+xml;application/xml;application/vnd.mozilla.xul+xml;application/rss+xml;application/rdf+xml;image/gif;image/jpeg;image/png;x-scheme-handler/http;x-scheme-handler/https;\nStartupWMClass=Firefox\nStartupNotify=true" | sudo tee /usr/share/applications/firefox-latest.desktop

    rm -rf $TEMP_PATH

else
    echo 'Please run as superuser'
fi

